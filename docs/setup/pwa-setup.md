# Progressive Web App (PWA) Setup

## Overview

WiredLiving has been configured as a Progressive Web App (PWA), providing an app-like experience with offline capabilities, installability, and improved performance.

## Features

### ðŸš€ Core PWA Features

- **Installable**: Users can install the app on their devices (mobile and desktop)
- **Offline Support**: Core pages and assets are cached for offline access
- **Fast Loading**: Assets are cached for improved performance
- **App-like Experience**: Runs in standalone mode without browser UI
- **Responsive**: Works seamlessly across all devices

### ðŸ“± Mobile Optimizations

- **Add to Home Screen**: Users can add the app to their device home screen
- **Splash Screen**: Custom branding when launching the app
- **Status Bar Styling**: Native-looking status bar on iOS
- **App Shortcuts**: Quick access to key sections (Home, Blog, Search)

## Configuration

### Manifest File

Location: `/public/manifest.json`

Key settings:
- **Name**: WiredLiving - Your Digital Lifestyle Hub
- **Short Name**: WiredLiving
- **Display Mode**: Standalone
- **Theme Color**: #0ea5e9 (Sky blue)
- **Background Color**: #ffffff (White)

### Service Worker

The service worker is automatically generated by `next-pwa` and handles:

1. **Asset Caching**
   - Static assets (CSS, JS)
   - Images (JPG, PNG, SVG, WebP)
   - Fonts (Google Fonts and local)

2. **Caching Strategies**
   - **CacheFirst**: Google Fonts (1 year)
   - **StaleWhileRevalidate**: Static assets, images, fonts
   - **NetworkFirst**: API calls, JSON data (5 min cache)

3. **Runtime Caching**
   - API responses cached for 5 minutes
   - Images cached for 24 hours
   - Style assets cached for 24 hours

### Icons

Required PWA icons are located in `/public/favicon_io/`:
- `android-chrome-192x192.png` - Android home screen
- `android-chrome-512x512.png` - Android splash screen
- `apple-touch-icon.png` - iOS home screen
- `favicon-16x16.png` & `favicon-32x32.png` - Browser favicons

## Installation Guide

### For Users

#### Desktop (Chrome/Edge)
1. Visit the website
2. Look for the install icon in the address bar
3. Click "Install" to add to desktop

#### Mobile (iOS)
1. Open in Safari
2. Tap the Share button
3. Select "Add to Home Screen"
4. Tap "Add"

#### Mobile (Android)
1. Open in Chrome
2. Tap the menu (three dots)
3. Select "Add to Home screen"
4. Tap "Add"

## Testing

### Local Testing

```bash
# Build the production version
npm run build

# Start the production server
npm start
```

Then visit `http://localhost:3000` and:

1. Open DevTools (F12)
2. Go to Application tab
3. Check:
   - Manifest
   - Service Workers
   - Cache Storage

### Lighthouse Audit

Run a Lighthouse audit to verify PWA compliance:

1. Open DevTools (F12)
2. Go to Lighthouse tab
3. Select "Progressive Web App"
4. Click "Generate report"

Target Score: 90+ for PWA

### Testing Offline Mode

1. Build and start the production server
2. Visit a few pages to cache them
3. In DevTools, go to Network tab
4. Select "Offline" from the throttling dropdown
5. Navigate through the site - cached pages should load

## Development

### Disabling PWA in Development

PWA features are automatically disabled in development mode for easier debugging:

```javascript
disable: process.env.NODE_ENV === 'development'
```

### Building for Production

```bash
npm run build
```

This will:
1. Generate the service worker (`sw.js`)
2. Create workbox files for caching
3. Build optimized static assets

### Generated Files

After building, these files are created in `/public/`:
- `sw.js` - Service worker
- `workbox-*.js` - Workbox runtime files
- `worker-*.js` - Worker files

**Note**: These are git-ignored and regenerated on each build.

## Customization

### Updating the Manifest

Edit `/public/manifest.json` to customize:
- App name and description
- Theme colors
- Display mode
- Shortcuts
- Categories

### Modifying Cache Strategy

Edit `/next.config.mjs` to adjust:
- Cache duration
- Cache names
- URL patterns
- Caching strategies

### Adding App Shortcuts

Update the `shortcuts` array in `manifest.json`:

```json
{
  "name": "New Feature",
  "short_name": "Feature",
  "description": "Description",
  "url": "/feature-path",
  "icons": [{ "src": "/icon.png", "sizes": "192x192" }]
}
```

## Browser Support

- âœ… Chrome/Edge (Full support)
- âœ… Safari iOS 11.3+ (Most features)
- âœ… Firefox (Full support)
- âœ… Samsung Internet (Full support)
- âš ï¸ Safari macOS (Limited support)

## Troubleshooting

### Service Worker Not Registering

1. Ensure you're testing in production mode
2. Check browser console for errors
3. Verify HTTPS (required for PWA)
4. Clear browser cache and storage

### Manifest Not Loading

1. Check the manifest file is valid JSON
2. Verify the path in `layout.tsx` is correct
3. Check browser DevTools Application > Manifest

### Icons Not Showing

1. Ensure icon files exist in `/public/favicon_io/`
2. Verify icon paths in `manifest.json`
3. Check icon sizes match manifest specifications

### Cache Not Working

1. Build in production mode
2. Visit pages to populate cache
3. Check DevTools Application > Cache Storage
4. Verify service worker is active

## Performance Optimizations

The PWA configuration includes several optimizations:

1. **Precaching**: Critical assets are cached on install
2. **Runtime Caching**: Dynamic content is cached on first access
3. **Stale-While-Revalidate**: Shows cached content while updating
4. **Network Timeout**: Falls back to cache if network is slow

## Security

- Service workers only work over HTTPS
- Cross-origin resources use proper CORS headers
- Cache storage is origin-isolated
- Service worker scope is limited to app origin

## Updates

When you update the app:

1. Service worker detects changes
2. New version is downloaded in background
3. Activates on next page load
4. Users see updated content

To force immediate updates, users can:
- Close all app tabs and reopen
- Use browser's "Refresh" button
- Clear site data

## Resources

- [PWA Documentation](https://web.dev/progressive-web-apps/)
- [Next-PWA GitHub](https://github.com/shadowwalker/next-pwa)
- [Workbox Documentation](https://developers.google.com/web/tools/workbox)
- [Web App Manifest](https://developer.mozilla.org/en-US/docs/Web/Manifest)

## Monitoring

Monitor PWA metrics:
- Install rate
- Offline usage
- Cache hit rate
- Service worker errors

Use Google Analytics or similar tools to track these metrics.

## Next Steps

1. âœ… Test installation on various devices
2. âœ… Run Lighthouse audit
3. âœ… Test offline functionality
4. â¬œ Add push notifications (optional)
5. â¬œ Implement background sync (optional)
6. â¬œ Add share target API (optional)

## Support

For issues or questions:
- Check browser console for errors
- Review service worker logs
- Test in different browsers
- Verify production build works correctly
